const navMenuItem=document.querySelectorAll(".nav-menu-container"),nav=document.querySelector(".nav"),order=document.querySelector(".order"),orderPresent=document.querySelector(".order__present"),orderAbsent=document.querySelector(".order__absent");let orderList=document.querySelector(".order__list");const mainContent=document.querySelector(".main-content");function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}nav.addEventListener("click",e=>{order.style.display="none",mainContent.style.display="block",e.target&&e.target.classList.contains("nav-menu-container")&&navMenuItem.forEach((t,r)=>{e.target==t?t.classList.add("_active"):t.classList.remove("_active")})}),testWebP((function(e){1==e&&document.querySelector("body").classList.add("webp")})),$(".tab_item").not(":first").hide(),$(navMenuItem).first().addClass("_active"),$(".tab").click((function(){$(".tab").removeClass("active").eq($(this).index()).addClass("active"),$(".tab_item").hide().eq($(this).index()).fadeIn()})).eq(0).addClass("active");const header=$(".header__top-header"),slider=$(".slider"),sliderHeight=slider.height(),hederHeight=header.height();$(window).scroll((function(){$(this).scrollTop()>75?(header.addClass("header__top-header__fixed"),$("body").css({paddingTop:hederHeight+"px"})):(header.removeClass("header__top-header__fixed"),$("body").css({paddingTop:0}))})),$((function(){$(".scrollupBtn").each((function(e){$(this).on("click",(function(){$("html, body").animate({scrollTop:0},800)}))}))})),$(window).scroll((function(){$(this).scrollTop()>200?$(".scrollup").fadeIn():$(".scrollup").fadeOut()})),document.addEventListener("DOMContentLoaded",(function(){new SimpleAdaptiveSlider(".slider",{autoplay:!1,interval:5e3,swipe:!0})}));const basket=document.querySelector(".header__basket"),toBasket=document.querySelectorAll(".pizza__basket"),basketQuantity=document.querySelector(".header__basket-quantity");function renderNewEl(e){let t,r=e.target.closest(".pizza__container"),n=r.querySelector("img").getAttribute("src"),a=r.querySelector(".pizza__name").innerText,o=r.querySelector(".pizza__ingredients").innerText,l=r.querySelector(".pizza__grn").innerText,i=document.createElement("div");i.classList.add("order__item"),i.innerHTML=`\n      <div class="order__item-details">\n      <div class="item-img">\n        <img src="${n}" alt="">\n        <div class="order__quantity">\n          <div class="order__minus-quantity quantity-img">\n          </div>\n          <span class="order__current-quantity">1</span>\n          <div class="order__plus-quantity quantity-img">\n          </div>\n        </div>\n      </div>\n      <div class="order__item-description">\n        <div class="order__item-name">${a}</div>\n        <input type="hidden" name="pizza_name[]" " value="${a}">\n        <div class="order__item-ingredients">${o}</div>\n        <div class="order__price-value"><span class="order__price-grn-value">${l}</span></div>\n      </div>\n      <div class="order__close-button">X</div>\n    </div>\n    <div class="order__item-price">\n      <div class="order__finally-price">\n        Всього: <span class="order__finally-price-value">${l}</span>\n      </div>\n    </div>\n  `,t=i.querySelector(".order__current-quantity").innerText,console.log(t),orderList.append(i)}function plusQuantity(e){let t=e.target.closest(".order__item"),r=t.querySelector(".order__current-quantity"),n=t.querySelector(".order__current-quantity").innerText,a=t.querySelector('input[name="pizza_name[]"]'),o=t.querySelector(".order__item-name").innerText;r.innerText=++n,a.value=`${o} ${n}шт`,console.log(a.value)}function minusQuantity(e){let t=e.target.closest(".order__item"),r=t.querySelector(".order__current-quantity"),n=t.querySelector(".order__current-quantity").innerText,a=t.querySelector('input[name="pizza_name[]"]'),o=t.querySelector(".order__item-name").innerText;0==!n&&n>1&&(r.innerText=--n,a.value=`${o} ${n}шт;`,console.log(a.value))}function calculateQuantity(e){let t=e.target.closest(".order__item"),r=t.querySelector(".order__current-quantity").innerText,n=parseInt(t.querySelector(".order__price-value").innerText.match(/\d+/));t.querySelector(".order__finally-price-value").innerText=r*n+" грн"}function removeOrderItem(e){e.target.closest(".order__item").remove(),calculateBasketQuantity(),calculateTotalPay()}basket.addEventListener("click",()=>{order.style.display="block",mainContent.style.display="none",orderList.childElementCount>0?(orderPresent.style.display="block",orderAbsent.style.display="none"):(orderPresent.style.display="none",orderAbsent.style.display="block"),navMenuItem.forEach(e=>{e.classList.remove("_active")})}),toBasket.forEach(e=>{e.addEventListener("click",e=>{renderNewEl(e),calculateBasketQuantity(e),calculateTotalPay()})}),orderList.addEventListener("click",e=>{e.target.classList.contains("order__plus-quantity")?(plusQuantity(e),calculateQuantity(e),calculateTotalPay()):e.target.classList.contains("order__minus-quantity")?(minusQuantity(e),calculateQuantity(e),calculateTotalPay()):e.target.classList.contains("order__close-button")&&removeOrderItem(e)}),(calculateBasketQuantity=()=>{orderList.childElementCount>0?basketQuantity.style.opacity="1":basketQuantity.style.opacity="0",basketQuantity.innerText=orderList.childElementCount,console.log(orderList.childElementCount)})(),calculateTotalPay=()=>{const e=document.querySelectorAll(".order__finally-price-value"),t=document.querySelector(".order__total-pay-value");let r=document.querySelector('input[name="pizza_price"]'),n=0;e.forEach(e=>{n+=Number(e.innerText.match(/\d+/))}),t.innerText=n,r.value=t.innerText};const forms=document.querySelectorAll("form"),message={loading:"Загрузка...",success:"Спасибо! Скоро мы с вами свяжемся",failure:"Что-то пошло не так..."};function postData(e){e.addEventListener("submit",t=>{t.preventDefault();let r=document.createElement("div");r.classList.add("status"),e.appendChild(r);const n=new XMLHttpRequest;n.open("POST","telegram.php");const a=new FormData(e);n.send(a),n.addEventListener("load",()=>{200===n.status?(console.log(n.response),openModal(),e.reset(),clearOrderCard(),setTimeout(()=>{closeModal()},3500),orderPresent.style.display="none",orderAbsent.style.display="block"):r.textContent=message.failure})})}forms.forEach(e=>{postData(e)});const modalTrigger=document.querySelectorAll("[data-modal]"),modal=document.querySelector(".modal"),modalCloseBtn=document.querySelector("[data-close]");function clearOrderCard(){document.querySelectorAll(".order__item").forEach(e=>{e.remove()})}function closeModal(){modal.classList.add("hide"),modal.classList.remove("show"),document.body.style.overflow=""}function openModal(){modal.classList.add("show"),modal.classList.remove("hide"),document.body.style.overflow="hidden"}modalTrigger.forEach(e=>{e.addEventListener("click",openModal)}),modalCloseBtn.addEventListener("click",closeModal),modal.addEventListener("click",e=>{e.target===modal&&closeModal()}),document.addEventListener("keydown",e=>{"Escape"===e.code&&modal.classList.contains("show")&&closeModal()});